; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --version 5
; RUN: opt -passes=instcombine -S < %s | FileCheck %s

; We shouldn't fold bitcast(insert <vscale x 1 x iX> .., iX %val, i32 0)
; into bitcast(iX %val) for scalable vectors.
define <vscale x 2 x i8> @bitcast_of_insert_i8_i16(i16 %val) #0 {
; CHECK-LABEL: define <vscale x 2 x i8> @bitcast_of_insert_i8_i16(
; CHECK-SAME: i16 [[VAL:%.*]]) {
; CHECK-NEXT:  [[ENTRY:.*:]]
; CHECK-NEXT:    [[OP2:%.*]] = insertelement <vscale x 1 x i16> poison, i16 [[VAL]], i64 0
; CHECK-NEXT:    [[TMP0:%.*]] = bitcast <vscale x 1 x i16> [[OP2]] to <vscale x 2 x i8>
; CHECK-NEXT:    ret <vscale x 2 x i8> [[TMP0]]
;
entry:
  %op2 = insertelement <vscale x 1 x i16> poison, i16 %val, i32 0
  %0 = bitcast <vscale x 1 x i16> %op2 to <vscale x 2 x i8>
  ret <vscale x 2 x i8> %0
}
