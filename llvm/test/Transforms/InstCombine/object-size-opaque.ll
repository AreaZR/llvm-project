; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --version 5
; RUN: opt -passes=instcombine -S %s | FileCheck %s
%opaque = type opaque

define void @foo(ptr sret(%opaque) %in, ptr %sizeptr) {
; CHECK-LABEL: define void @foo(
; CHECK-SAME: ptr sret([[OPAQUE:%.*]]) [[IN:%.*]], ptr [[SIZEPTR:%.*]]) {
; CHECK-NEXT:    [[SIZE:%.*]] = call i64 @llvm.objectsize.i64.p0(ptr [[IN]], i1 false, i1 false, i1 false)
; CHECK-NEXT:    store i64 [[SIZE]], ptr [[SIZEPTR]], align 4
; CHECK-NEXT:    ret void
;
  %size = call i64 @llvm.objectsize.i64(ptr %in, i1 0, i1 0, i1 0)
  store i64 %size, ptr %sizeptr
  ret void
}

declare i64 @llvm.objectsize.i64(ptr, i1, i1, i1)
